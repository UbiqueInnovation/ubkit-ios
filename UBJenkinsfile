pipeline {
	agent none
	stages {
		stage("Build") {
			parallel {
				stage("Codequality") {
					agent {
						label "ios"
					}
					environment {
						FL_SONAR_LOGIN = credentials("sonarcloudlogin")
						FL_SONAR_RUNNER_PROJECT_KEY = "ubique-innovation_ubfoundation-swift"
						FL_SONAR_RUNNER_PROJECT_NAME = "UBFoundation-Swift"
					}
					steps {
						fastlane lane:"codequality"
					}
				}
				stage("Documentation") {
					/*when { anyOf { branch 'master'; branch 'develop' } }*/
					agent {
						label"ios"
					}
					steps {
						sh "gem install jazzy"
						fastlane lane:"documentation"
					}
				}
				stage("Tests") {
					agent {
						label "ios"
					}
					steps {
						fastlane lane:"tests"
					}
					post {
						always {
							junit skipPublishingChecks: true, testResults: "fastlane/test_output/*.junit"
						}
					}
				}
			}
		}
	}
}

